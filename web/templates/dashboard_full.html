<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>IntelliSniff ‚Äî –¶–µ–Ω—Ç—Ä –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç—Ä–∞—Ñ–∏–∫–∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', path='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="{{ url_for('static', path='app.js') }}"></script>
</head>
<body>
<div id="authOverlay" class="auth-overlay hidden">
    <form id="authForm" class="auth-card">
        <h2>–í—Ö–æ–¥ –≤ IntelliSniff</h2>
        <p class="auth-subtitle">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (HTTP Basic).</p>
        <label>
            –õ–æ–≥–∏–Ω
            <input type="text" id="authLogin" autocomplete="username" required>
        </label>
        <label>
            –ü–∞—Ä–æ–ª—å
            <input type="password" id="authPassword" autocomplete="current-password" required>
        </label>
        <button type="submit">–í–æ–π—Ç–∏</button>
        <p class="auth-hint">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: <code>admin / changeme</code>. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
            <code>TA_USER</code>, <code>TA_PASS</code>.</p>
    </form>
</div>

<header class="page-header">
    <div>
        <h1>IntelliSniff</h1>
        <p class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤</p>
    </div>
    <div class="header-meta">
        <div id="statusBadge" class="status-badge status-idle">–û–∂–∏–¥–∞–Ω–∏–µ</div>
        <div class="user-meta">–í–∞—à IP: {{ request.client.host }}</div>
        <a href="/logs" class="nav-btn">üìò –ñ—É—Ä–Ω–∞–ª</a>
    </div>
</header>

<section class="controls-card">
    <div class="controls-grid">
        <label>
            –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            <select id="iface">
                <option value="">–ê–≤—Ç–æ</option>
            </select>
        </label>
        <label>
            BPF-—Ñ–∏–ª—å—Ç—Ä
            <input id="bpf" placeholder="tcp port 80">
        </label>
        <label>
            –¢–∞–π–º–∞—É—Ç –ø–æ—Ç–æ–∫–∞ (—Å)
            <input id="flowTimeout" type="number" min="1" max="600" step="1" value="30">
        </label>
        <label class="checkbox">
            <input type="checkbox" id="use_nfstream"> –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ NFStream
        </label>
        <div class="buttons">
            <button id="startBtn" class="primary">–ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞—Ö–≤–∞—Ç</button>
            <button id="stopBtn" class="ghost">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="buttons">
            <button id="trainBtn" class="ghost">–ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å</button>
            <button id="csvBtn" class="ghost">–≠–∫—Å–ø–æ—Ä—Ç CSV</button>
            <button id="pdfBtn" class="ghost">–≠–∫—Å–ø–æ—Ä—Ç PDF</button>
        </div>
    </div>
    <div id="statusDetails" class="status-details"></div>
</section>

<section class="ml-section">
    <div class="ml-header">
        <h2>ML-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h2>
        <label class="ml-toggle">
            <input type="checkbox" id="autoUpdateToggle" checked>
            <span>–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</span>
        </label>
    </div>
    <div class="ml-grid" id="mlGrid">
        <div class="ml-card" data-task="attack">
            <div class="ml-card-header">
                <h3>–î–µ—Ç–µ–∫—Ü–∏—è –∞—Ç–∞–∫</h3>
                <span class="ml-active" data-role="active">‚Äî</span>
            </div>
            <label>–§–∞–π–ª –º–æ–¥–µ–ª–∏ (*.joblib)
                <select data-role="versions"></select>
            </label>
            <div class="ml-actions">
                <button data-action="switch" class="primary">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                <button data-action="validate" class="ghost">–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="ml-metrics" data-role="metrics"></div>
            <div class="ml-drift" data-role="drift">–î—Ä–µ–π—Ñ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω</div>
        </div>
        <div class="ml-card" data-task="vpn">
            <div class="ml-card-header">
                <h3>VPN –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
                <span class="ml-active" data-role="active">‚Äî</span>
            </div>
            <label>–§–∞–π–ª –º–æ–¥–µ–ª–∏ (*.joblib)
                <select data-role="versions"></select>
            </label>
            <div class="ml-actions">
                <button data-action="switch" class="primary">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                <button data-action="validate" class="ghost">–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="ml-metrics" data-role="metrics"></div>
            <div class="ml-drift" data-role="drift">–î—Ä–µ–π—Ñ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω</div>
        </div>
        <div class="ml-card" data-task="anomaly">
            <div class="ml-card-header">
                <h3>–ê–Ω–æ–º–∞–ª–∏–∏</h3>
                <span class="ml-active" data-role="active">‚Äî</span>
            </div>
            <label>–§–∞–π–ª –º–æ–¥–µ–ª–∏ (*.joblib)
                <select data-role="versions"></select>
            </label>
            <div class="ml-actions">
                <button data-action="switch" class="primary">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                <button data-action="validate" class="ghost">–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="ml-metrics" data-role="metrics"></div>
            <div class="ml-drift" data-role="drift">–î—Ä–µ–π—Ñ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω</div>
        </div>
    </div>
    <div class="ml-predictions">
        <div class="ml-predictions-header">
            <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π</h3>
            <div class="ml-predictions-actions">
                <label class="inline-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å
                    <select id="mlPredictionsLimit">
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="all">–í—Å–µ</option>
                    </select>
                </label>
                <button id="toggleMlPredictions" class="ghost">–°–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <button id="refreshMl" class="ghost">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>
        <div id="mlPredictionsPanel" class="collapsible expanded">
            <div class="ml-predictions-table">
                <table id="mlPredictions">
                    <thead>
                    <tr>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–ú–æ–¥–µ–ª—å</th>
                        <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                        <th>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</th>
                        <th>–í–µ—Ä—Å–∏—è</th>
                        <th>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<section class="cards-grid">
    <div class="info-card">
        <h3>–í—Å–µ–≥–æ –ø–æ—Ç–æ–∫–æ–≤</h3>
        <div class="metric" id="totalFlows">0</div>
        <span class="hint">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–µ—Å—Å–∏—é</span>
    </div>
    <div class="info-card">
        <h3>–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ</h3>
        <div class="metric warning" id="suspiciousFlows">0</div>
        <span class="hint">–ú–µ—Ç–∫–∏, –æ—Ç–ª–∏—á–Ω—ã–µ –æ—Ç "web" / "benign"</span>
    </div>
    <div class="info-card">
        <h3>–°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å</h3>
        <div class="metric" id="bandwidth">0 –ö–ë/—Å</div>
        <span class="hint">–ü–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º –ø–æ—Ç–æ–∫–∞–º</span>
    </div>
    <div class="info-card">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Ç–æ–∫</h3>
        <div class="metric" id="lastFlowLabel">‚Äî</div>
        <span class="hint" id="lastFlowSummary">–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</span>
    </div>
</section>

<section class="charts-grid">
    <div class="chart-card">
        <div class="chart-header">
            <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫</h3>
            <select id="labelFilter">
                <option value="all" selected>–í—Å–µ –º–µ—Ç–∫–∏</option>
            </select>
        </div>
        <canvas id="labelsChart" width="420" height="260"></canvas>
    </div>
    <div class="chart-card">
        <h3>–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤</h3>
        <canvas id="trafficChart" width="420" height="260"></canvas>
    </div>
    <div class="chart-card">
        <h3>–¢–æ–ø –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h3>
        <canvas id="destChart" width="420" height="260"></canvas>
    </div>
</section>

<section class="table-card">
    <div class="table-header">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Ç–æ–∫–∏</h3>
        <div class="table-controls">
            <label>–ü–æ–∏—Å–∫ <input type="search" id="tableSearch" placeholder="IP, –ø–æ—Ä—Ç –∏–ª–∏ –º–µ—Ç–∫–∞"></label>
            <label class="inline-label">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å
                <select id="flowTableLimit">
                    <option value="20">20</option>
                    <option value="50" selected>50</option>
                    <option value="100">100</option>
                    <option value="all">–í—Å–µ</option>
                </select>
            </label>
            <button id="toggleFlows" class="ghost">–°–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫</button>
            <span id="tableCounter">0 –∑–∞–ø–∏—Å–µ–π</span>
        </div>
    </div>
    <div id="flowsPanel" class="table-wrapper collapsible expanded">
        <table id="flowsTable">
            <thead>
            <tr>
                <th>–í—Ä–µ–º—è</th>
                <th>–ò—Å—Ç–æ—á–Ω–∏–∫</th>
                <th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th>
                <th>–ü–æ—Ä—Ç—ã</th>
                <th>–ü—Ä–æ—Ç–æ–∫–æ–ª</th>
                <th>–ú–µ—Ç–∫–∞</th>
                <th>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</th>
                <th>–ü–∞–∫–µ—Ç—ã</th>
                <th>–ë–∞–π—Ç—ã</th>
                <th>–°–≤–æ–¥–∫–∞</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</section>

<footer class="page-footer">
    <div>
        –í–µ—Ä—Å–∏—è –ø–∞–Ω–µ–ª–∏ IntelliSniff ¬∑ NFStream: <span id="nfStatus">‚Äî</span>
    </div>
    <div>
        –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ç–µ–≤–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∏ –º–æ–¥–µ–ª—å <code>data/model.joblib</code>.
    </div>
</footer>
</body>
</html>
